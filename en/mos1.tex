% !TeX root = mos-en.tex

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\refstepcounter{problem}  % 11. Silent cooperation

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\refstepcounter{problem}  % 12. Quo vadis?

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{prob}{The prisoner's dilemma\annotate{D}}

Three prisoners $A,B,C$ are eligible for parole. The parole board will release two of them with equal probability for $\{A,B\}, \{A,C\}, \{B,C\}$, so the probability that $A$ will be released is $2/3$. Prisoner $A$ is told the name of one of the other prisoners who will be released. If he is told that prisoner $B$ will be released, what is the probability that $A$ too will be released?

For a comprehensive article on the prisoner's dilemma problem and the related Monty Hall problem see \cite{carlton}.
\end{prob}

\solution{1}

Let $P(A), P(B), P(C)$ be the probabilities that $A,B,C$ are released. $A$ is interested in the conditional probability $P(A|B)$ of his being released if $B$ will be released:
\[
P(A|B) = \frac{P(A\cap B)}{P(B)} = \frac{1/3}{2/3}=\frac{1}{2}\,.
\]
But that is \emph{not} the correct conditional probability! Let $R_{AB}$ be the event that $A$ is \emph{told} that $B$ will be released. The probability that must be computed is $P(A|R_{AB})$:
\[
P(A|R_{AB}) = \frac{P(A\cap R_{AB})}{P(R_{AB})}\,.
\]
We assume that the report of $B$'s release is true so:
\[
P(A\cap R_{AB})=P(\{A,B\})=\disfrac{1}{3}\,.
\]
Now:
\[
P(R_{AB})=P(\{A,B\})+P(\{B,C\})=\disfrac{1}{3}+\disfrac{1}{2}\cdot \disfrac{1}{3}=\disfrac{1}{2}\,.
\]
If $\{B,C\}$ are to be released, $A$ could be told that either $B$ or $C$ is to be released, hence the factor of $1/2$. Therefore:
\[
P(A|R_{AB}) = \frac{P(A\cap R_{AB})}{P(R_{AB})} = \disfrac{1/3}{1/2}=\disfrac{2}{3}\,,
\]
so if $A$ is told that $B$ will be released the probability that he will be released does not change.

\solution{2}

There are four possible events:
\begin{description}
\item[$e_1$:] $A$ is told that $B$ will be released and $\{A,B\}$ are released. 
\item[$e_2$:] $A$ is told that $C$ will be released and $\{A,C\}$ are released. 
\item[$e_3$:] $A$ is told that $B$ will be released and $\{B,C\}$ are released. 
\item[$e_4$:] $A$ is told that $C$ will be released and $\{B,C\}$ are released. 
\end{description}
Each pair of prisoners has equal probability of being released so:
\[
P(e_1)=P(e_2)=P(e_3\cup e_4)=\frac{1}{3}\,.
\]
We assume that if $\{B,C\}$ are to be released, $A$ is told $B$ or $C$ with equal probability, so $P(e_3)=P(e_4)=1/6$. Therefore the probability that $A$ will be released given the event $R_{AB}=e_1\cup e_3$ that he is told that $B$ will be released is:
\[
P(A|R_{AB}) = \frac{P(e_1\cap(e_1\cup e_3))}{P(e_1\cup e_3)}=\frac{P(e_1)}{P(e_1\cup e_3)}=\frac{1/3}{(1/3)+(1/6)}=\frac{2}{3}\,.
\]

\solution{3}

A riddle attributed to Abraham Lincoln asks: ``If you call the tail of a dog a leg, how many legs does the dog have?'' The answer is that calling a tail a leg doesn't make it a leg, so the dog still has four legs. Clearly, whether $A$ knows $B$'s future doesn't change his chances of being released.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{prob}{Collecting coupons\annotate{S}}
Given a sequence of boxes each of which contains coupons numbered $1$ to $5$. You randomly draw one coupon from each box one after another.

\que{1} What is the expectation of the number of coupons drawn until you have all five of the numbers?

\que{2} Develop a formula for the expectation for $n$ numbers.

\textbf{Hint:} Use the solution to Problem~4 on page~\pageref{p.four} and the approximation for the sum of harmonic numbers (page~\pageref{p.harmonic}).
\end{prob}

\solution{}

\ans{1} What is the expectation of the number of draws until you get a  number that is \emph{different from} all the previous ones? By  Problem~4 this is $1/p$ where $p$ is the probability of drawing a different number. For the first draw the probability is $1$ so the expectation is also $1$, for the second draw the probability is $4/5$ so expectation is $5/4$, and so on. Therefore:
\[
E(\textsf{all five numbers}) = \frac{5}{5}+\frac{5}{4} + \frac{5}{3} + \frac{5}{2} + \frac{5}{1} = \frac{}{} =\frac{1370}{120}\approx 11.4167\,.
\]
\ans{2} Use the same method and the approximation for $H_n$, the $n$th harmonic number (page~\pageref{p.harmonic}):
\[
E(\textsf{all}\;n \;\textsf{numbers}) = n\left(\frac{1}{n}+\frac{1}{n-1} + \cdots \frac{1}{2} + \frac{1}{1}\right) =nH_n\approx n\left(\ln n + \frac{1}{2n} + 0.5772\right)\,. 
\]
For $n=5$ this gives:
\[
E(\textsf{all five numbers}) =5H_5\approx 5(\ln 5 + \frac{1}{10} + 0.5772) \approx 11.4332\,.
\]

\textbf{Simulation}
\begin{verbatim}
For  5 coupons:
Expectation of draws = 11.9332
Average draws        = 11.4272
For 10 coupons:
Expectation of draws = 29.7979
Average draws        = 29.2929
For 20 coupons:
Expectation of draws = 72.4586
Average draws        = 72.2136
\end{verbatim}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{prob}{The theater row\annotate{S}}
Arrange eight even numbers and seven odd numbers randomly in a row, for example:
\[
10\quad 12\quad 3\quad 2\quad 9\quad 6 \quad 1\quad 13\quad 7\quad 10\quad 3\quad 8\quad 8\quad 5\quad 20\,,
\]
which we can write as follows since the specific numbers are not important:
\[
E\quad E\quad O\quad E\quad O\quad E \quad O\quad O\quad O\quad E\quad O\quad E\quad E\quad O\quad E\,.
\]
What is the expectation of the number of even-odd or odd-even adjacent pairs?

In the example there are $10$ $EO$ or $OE$ adjacent pairs.

\textbf{Hint:} Consider each adjacent pair of separately. What is the probability that they are different?
\end{prob}

\solution{}

The following table shows the ten possible arrangements of three even and two odd numbers. The total number of different adjacent pairs is $24$ and the average is $24/10=2.4$.
\[
\begin{array}{l|r@{\hspace{2em}}|@{\hspace{2pt}}|@{\hspace{2em}}l|r}
\textsf{Arrangement}&\textsf{Pairs}&\textsf{Arrangement}&\textsf{Pairs}\\\hline
EEEOO & 1&
EEOEO & 3\\
EEOOE & 2&
EOEOE & 4\\
EOEEO & 3&
EOOEE & 1\\
OEEOE & 3&
OEEEO & 2\\
OEOEE & 3&
OOEEE & 1\\
\end{array}
\]
Return to the example with $15$ numbers. Let $P_d$ be the probability that a given pair in an arrangement is $EO$ or $OE$.  Then:
\[
P_d =P(EO) + P(OE) = \frac{8}{15}\cdot \frac{7}{14} + \frac{7}{15}\cdot \frac{8}{14} = 2\cdot \frac{8}{15}\cdot \frac{7}{14} = \frac{8}{15}\,.
\]
Let $E_d$ be the expectation of the number of pairs in an arrangement that are $EO$ or $OE$. Since an $(EO,OE)$ pair contributes $1$ to the count of different pairs and an $(EE,OO)$ pair contributes $0$:
\[
E_d =
\sum_{\textsf{\footnotesize pairs}} 1\cdot P_d= 14\cdot \frac{8}{15} \approx 7.4667\,.
\]

For ten numbers:
\begin{eqnarray*}
P_d &=& P(EO) + P(OE) = \frac{3}{5}\cdot \frac{2}{4} + \frac{2}{5}\cdot \frac{3}{4} = \frac{3}{5}\\
E_d &=& 4\cdot \frac{3}{5}=\frac{12}{5}=2.4\,.
\end{eqnarray*}

\textbf{Simulation}
\begin{verbatim}
For  5 places:
Expectation of different pairs = 2.4000
Average different pairs        = 2.3855
For 15 places:
Expectation of different pairs = 7.4667
Average different pairs        = 7.4566
For 27 places:
Expectation of different pairs = 13.4815
Average different pairs        = 13.4835
For 49 places:
Expectation of different pairs = 24.4898
Average different pairs        = 24.4725
\end{verbatim}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{prob}{Will the second-best be runner-up?\annotate{S}}
Eight players in a tournament $\{a_1,\ldots,a_8\}$ are randomly assigned to play games $\{g_1,\ldots,g_8\}$ in a schedule such that player $a_{k_{i}}$ initially plays in position $g_{k_{i}}$ (Figure~\ref{f.tournament}). The players are ranked from the best $a_1$ to the worst $a_8$ and the better player will \emph{always} defeat her opponent.  Clearly $a_1$ will win the tournament.

\que{1} What is the probability that $a_2$ will be the runner-up by playing $a_1$ in the final round and losing to her?

\que{2} If there are $2^n$ players what is the probability that $a_2$ will be the runner-up by playing $a_1$ in the final round and losing to her?
\end{prob}
\begin{figure}[tb]
\begin{center}
\begin{tikzpicture}[scale=.75]
\foreach \n in {1,2,3,4,5,6,7,8}
  \node (\n) at (0,\n*10mm) {$g_{\n}$};
\foreach \n in {1,2,3,4}
  \node[inner sep=-4pt] (r\n) at (30mm,-5mm+\n*20mm) {};
\foreach \n/\r in {1/1,2/1,3/2,4/2,5/3,6/3,7/4,8/4}
  \draw (\n) --
     node[fill=white] {$a_{k_{\n}}$} +(20mm,0) -- (r\r);
\foreach \n/\v in {1/25mm,2/65mm}
  \node[inner sep=-5pt] (rr\n) at (60mm,\v) {};
\foreach \n/\r in {1/1,2/1,3/2,4/2}
  \draw ($(r\n)+(-1pt,0)$) -- +(20mm,0) -- (rr\r);
\node[inner sep=-5pt] (rrr) at (90mm,45mm) {};
\foreach \n/\r in {1,2}
  \draw ($(rr\n)+(-1pt,0)$) -- +(20mm,0) -- (rrr); 
\draw ($(rrr)+(-1pt,0)$) -- +(20mm,0);
\node at (22mm,88mm) {\textsf{\small Quarterfinals}};
\node at (52mm,88mm) {\textsf{\small Semifinals}};
\node at (82mm,88mm) {\textsf{\small Final}};
\end{tikzpicture}
\end{center}
\caption{A tournament schedule}\label{f.tournament}
\end{figure}

\solution{}

\ans{1}
If $a_1$ is assigned to one of the games $\{g_1,g_2,g_3,g_4\}$ none of the other players assigned to these games will reach the final, so $a_2$ must be assigned to one of $\{g_5,g_6,g_7,g_8\}$. The temptation is to conclude that the probability of $a_2$ being the runner-up is $1/2$ since he must be assigned to one of the four games $\{g_1,g_2,g_3,g_4\}$. However, whatever game $a_1$ is  assigned to, $a_2$ will be the runner up only if he is assigned to one of four of the remaining seven games so the probability is $4/7$.

\ans{2} Similarly, of the $2^n-1$ games that $a_1$ is not assigned to, $a_2$ must be assigned to one of the $2^{n-1}$ games not in the same half as $a_1$. Therefore:
\[
P(a_1,a_2\;\textsf{playing each other in the final})=\frac{2^{n-1}}{2^n-1}\,.
\]

\textbf{Simulation}
\begin{verbatim}
For   8 players:
Probability a2 is runner-up                = 0.5714
Proportion of games where a2 is runner-up  = 0.5707
For  32 players:
Probability a2 is runner-up                = 0.5161
Proportion of games where a2 is runner-up  = 0.5184
For 128 players:
Probability a2 is runner-up                = 0.5039
Proportion of games where a2 is runner-up  = 0.5060
\end{verbatim}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{prob}{Twin knights\annotate{D,S}}

Eight players in a tournament $\{a_1,\ldots,a_8\}$ are randomly assigned to play games $\{g_1,\ldots,g_8\}$ in a schedule such that $a_{k_{i}}$ initially plays in position $g_{k_{i}}$ (Figure~\ref{f.tournament}). For all $i,j$, the probability that $a_i$ wins in a game against $a_j$ is $1/2$ as is the probability that $a_j$ wins against $a_i$.

\que{1} What is the probability that $a_1,a_2$ play each other?

\que{2} If there are $2^n$ players, what is the probability that $a_1,a_2$ play each other?
\end{prob}

\solution{}

\ans{1} Without loss of generality assign $a_1$ to $g_1$. Consider the different possibilities that $a_1,a_2$ play each other. With probability $1/7$, $a_2$ is assigned to $g_2$. With probability $2/7$, $a_2$ is assigned to $g_3$ or $g_4$, but he doesn't play $a_1$ unless \emph{both} of them win their first game, so we need to multiply the probability of this assignment by $1/4$. With probability $4/7$, $a_2$ is assigned to $g_5,g_6,g_7,g_8$, but he doesn't play $a_1$ unless \emph{both} of them win their first two  games, so we need to multiply the probability of this assignment by $1/16$. Therefore:
\[
P(a_1, a_2\;\textsf{play each other})=\frac{1}{7} + \frac{1}{4}\cdot \frac{2}{7} + \frac{1}{16}\cdot \frac{4}{7} =\frac{1}{4}\,.
\]

\ans{2}
Let $P_n$ be the probability that in a tournament with $2^n$ players, $a_1$ and $a_2$ play each other. We have shown that $P_3=1/4$. What about $P_4$? Using the same approach:
\begin{eqnarray*}
P_4 &=& \frac{1}{15} + \frac{1}{4}\cdot \frac{2}{15}  + \frac{1}{16}\cdot \frac{4}{15}  + \frac{1}{64}\cdot \frac{8}{15} \\
&=&\frac{1}{15}\left(1+\frac{1}{2}+\frac{1}{4}+\frac{1}{8}\right)=\frac{1}{8}\,.
\end{eqnarray*}
It is reasonable to conjecture that $P_n=1/2^{n-1}$.

\textbf{Proof 1:} Using the same approach and the formula for the sum of a geometric series:
\begin{eqnarray*}
P_n&=&\frac{1}{2^n-1}\sum_{i=0}^{n-1}2^i\cdot \left(\frac{1}{2}\right)^{2i}\\
&=&\frac{1}{2^n-1}\sum_{i=0}^{n-1}2^{-i}\\
&=&\frac{1}{2^n-1}
  \left(
    \frac{1-\left(\frac{1}{2}\right)^{(n-1)+1}}
         {1-\frac{1}{2}}
  \right)=\frac{1}{2^{n-1}}\,.
\end{eqnarray*}

\textbf{Proof 2:} By induction. The base case is $P_3=1/4=1/2^{3-1}$.

There are two inductive steps:

\textit{Case 1:} $a_1$ and $a_2$ are assigned to different halves of the tournament:
\[
P(a_1,a_2\;\textsf{assigned to different halves})=\frac{2^{n-1}}{2^n-1}\,.
\]
They can only meet in the final game and therefore both must win all of their $n-1$ games:
\begin{equation}\label{eq.17a}
P(a_1,a_2\;\textsf{meet if assigned to different halves})=\frac{2^{n-1}}{2^n-1} \left(\frac{1}{2}\right)^{n-1} \left(\frac{1}{2}\right)^{n-1}=\frac{2^{-(n-1)}}{2^n-1}\,.
\end{equation}
\textit{Case 2:} $a_1$ and $a_2$ are assigned to the same half of the tournament:
\[
P(a_1,a_2\;\textsf{assigned to the same half})=\frac{2^{n-1}-1}{2^n-1}\,.
\]
Since both players are in the same half the problem has been reduced to determining $P_{n-1}$. By the inductive hypothesis:
\begin{equation}\label{eq.17b}
P(a_1,a_2\;\textsf{meet if assigned to the same half})=\frac{2^{n-1}-1}{2^n-1}\cdot \frac{1}{2^{n-2}}=\frac{2^{1}-2^{-(n-2)}}{2^n-1}\,.
\end{equation}
Combining Equations~\ref{eq.17a}, \ref{eq.17b} gives:
\[
\renewcommand*{\arraystretch}{2.2}
\begin{array}{rcl}
P_n&=&\disfrac{2^{-(n-1)}}{2^n-1}+\disfrac{2^{1}-2^{-(n-2)}}{2^n-1}\\
&=&\disfrac{2^{n-1}}
        {2^{n-1}}\cdot 
   \disfrac{2^{-(n-1)}+2^{1}-2^{-(n-2)}}
        {2^n-1}\\
&=&\disfrac{1}
        {2^{n-1}}\cdot 
   \disfrac{2^0+2^n-2^1}
        {2^n-1}=\disfrac{1}{2^{n-1}}\,.
\end{array}
\]

\textbf{Simulation}
\begin{verbatim}
For   8 players:
Probability that a1, a2 meet = 0.2500
Proportion a1, a2 meet       = 0.2475
For  32 players:
Probability that a1, a2 meet = 0.0625
Proportion a1, a2 meet       = 0.0644
For 128 players:
Probability that a1, a2 meet = 0.0156
Proportion a1, a2 meet       = 0.0137
\end{verbatim}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{prob}{An even split at coin tossing\annotate{S}}
\que{1} If you toss a fair coin $20$ times, what is the probability of obtaining exactly $10$ heads?

\que{2} If you toss a fair coin $40$ times, what is the probability of obtaining exactly $20$ heads?
\end{prob}

\solution{}

\ans{1} Since the coin is fair the probability of obtaining $10$ heads in $20$ tosses is given by the binomial coefficient:
\[
P(10\;\textsf{heads in}\; 20\; \textsf{tosses})={20 \choose 10} \left(\frac{1}{2}\right)^{10}\left(\frac{1}{2}\right)^{10} \approx 0.1762\,.
\]

\ans{2} You might expect the probability to be the same as in the previous question, but:
\[
P(20\;\textsf{heads in}\; 40\; \textsf{tosses})={40 \choose 20} \left(\frac{1}{2}\right)^{20}\left(\frac{1}{2}\right)^{20}\approx 0.1254\,.
\]
By the law of large numbers the numbers of heads and tails will be ``roughly'' equal \cite[Section~8.4]{ross}, but they are unlikely to be exactly the same, and this event becomes less likely as the number of tosses increases.

\textbf{Simulation}
\begin{verbatim}
Probability of 10 heads for  20 tosses = 0.1762
Proportion  of 10 heads for  20 tosses = 0.1790
Probability of 20 heads for  40 tosses = 0.1254
Proportion  of 20 heads for  40 tosses = 0.1212
Probability of 50 heads for 100 tosses = 0.0796
Proportion  of 50 heads for 100 tosses = 0.0785
\end{verbatim}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{prob}{Isaac Newton helps Samuel Pepys\annotate{S}}
\que{1} What is the probability of obtaining \emph{at least one} $6$ when $6$ dice are thrown?

\que{2} What is the probability of obtaining \emph{at least two} $6$s when $12$ dice are thrown?

\que{3} Develop a formula for the probability of obtaining at least $n$ $6$s when $6n$ dice are thrown.
\end{prob}

\solution{}

\ans{1} The probability is the complement of the probability of obtain zero $6$s in $6$ throws, which is the product of obtaining a number different from $6$ in all throws:
\[
P(\textsf{at least one}\; 6)=1-\left(\frac{5}{6}\right)^6\approx 0.6651\,.
\]

\ans{2} The probability is the complement of the probability of obtain zero or one $6$s in $12$ throws:
\[
P(\textsf{at least two}\;6\textsf{s})=1-\left(\frac{5}{6}\right)^{12}-{12\choose 1}\left(\frac{1}{6}\right)^{1}\left(\frac{5}{6}\right)^{11}\approx 0.6187\,.
\]
This event is less probable than the previous one.

\ans{3} The probability is the complement of the probability of obtain less than $n$ $6$s in $6n$ throws:
\begin{eqnarray*}
P(\textsf{at least}\;n\;6\textsf{s})&=&
  1-{6n \choose 0}\left(\frac{1}{6}\right)^0\left(\frac{5}{6}\right)^{6n-0}-
  {6n\choose 1}\left(\frac{1}{6}\right)^{1}\left(\frac{5}{6}\right)^{6n-1}-\cdots\\
&=&1-\sum_{i=0}^{n-1}{6n\choose i}\left(\frac{1}{6}\right)^{i}\left(\frac{5}{6}\right)^{6n-i}\,.
\end{eqnarray*}

\textbf{Simulation}
\begin{verbatim}
For   6 dice to throw  1 sixes:
Probability = 0.6651
Proportion  = 0.6566
For  12 dice to throw  2 sixes:
Probability = 0.6187
Proportion  = 0.6220
For  18 dice to throw  3 sixes:
Probability = 0.5973
Proportion  = 0.5949
For  96 dice to throw 16 sixes:
Probability = 0.5424
Proportion  = 0.5425
For 360 dice to throw 60 sixes:
Probability = 0.5219
Proportion  = 0.5250
\end{verbatim}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{prob}{The three-cornered duel\annotate{S}}
$A,B,C$ fight a sequence of duels. Each of them has a fixed probability of winning a duel regardless of who the opponent is:
\[
P(A)=0.3,\quad P(B)=1, \quad P(C)=0.5\,.
\]
A person who is hit no longer participates in the duels. The shots are fired one at a time sequentially in the order $A,B,C$. If two opponents are still standing the shooter can decide whom to fire at. Assume that each person always makes an optimal decision.

\que{1} What is $A$'s optimal strategy?

\que{2} Suppose that $A$ fires the first shot into the air. Is this a better strategy?

\textbf{Hint:} Compute the conditional probabilities of $A$ winning depending on whether he chooses to shoot first at $B$ or $C$.
\end{prob}

\solution{}

Notation: $X\stackrel{H}{\longrightarrow}Y$ denotes that $X$ shoots at $Y$ and hits. $X\stackrel{M}{\longrightarrow}Y$ denotes that $X$ shoots at $Y$ and misses.

\ans{1}
Compute the conditional probabilities of $A$ winning.

\textit{Case 1:} $A$ chooses to shoot first at $C$.

If $A\stackrel{M}{\longrightarrow}C$ (probability $0.7$) then $B\stackrel{H}{\longrightarrow}C$ since $C$ is more dangerous than $A$. $A$ now shoots again at $B$ with probability $0.3$ of hitting, but if $A$ misses then $B\stackrel{H}{\longrightarrow}A$ with probability $1$ and $A$ loses.

If $A\stackrel{H}{\longrightarrow}C$ (probability $0.3$) then $B\stackrel{H}{\longrightarrow}A$ with probability $1$ and $A$ loses.

Compute the expectation with $1$ when $A$ wins and $0$ when $A$ loses:
\vspace*{-3ex}
\[
\renewcommand*{\arraystretch}{2.5}
\begin{array}{l}
E(A \;\textsf{wins}\;|A\;\textsf{chooses to shoot first at}\;C) =\\
%\qquad E(A \;\textsf{wins}\;|\;A\;\textsf{misses}\;C) + E(A \;\textsf{wins}\;|\;A\;\textsf{hits}\;C)=\\
\qquad \overbrace{1\cdot (0.7\cdot 0.3)}^{A\stackrel{M}{\longrightarrow}C, A\stackrel{H}{\longrightarrow}B}+ \overbrace{0\cdot (0.7\cdot 0.7\cdot 1)}^{A\stackrel{M}{\longrightarrow}C, A\stackrel{M}{\longrightarrow}B, B\stackrel{H}{\longrightarrow}A}+ \overbrace{0\cdot (0.3\cdot 1)}^{A\stackrel{M}{\longrightarrow}C, B\stackrel{H}{\longrightarrow}A}=0.2100\,.
\end{array}
\]
\textit{Case 2:} $A$ chooses to shoot first at $B$.

If $A\stackrel{M}{\longrightarrow}B$ (probability $0.7$) then as before $B\stackrel{H}{\longrightarrow}C$ and $A$ has one more chance to hit $B$ (probability $0.3$), otherwise $B\stackrel{H}{\longrightarrow}A$ with probability $1$ and $A$ loses.

If $A\stackrel{H}{\longrightarrow}B$ (probability $0.3$) then $A,C$ alternately shoot at each other until one is hit. The possibilities are:
\[
\begin{array}{ll}
(1)&C\stackrel{H}{\longrightarrow}A\\
(2)&C\stackrel{M}{\longrightarrow}A \stackrel{H}{\longrightarrow}C\\
(3)&C\stackrel{M}{\longrightarrow}A \stackrel{M}{\longrightarrow}C\stackrel{H}{\longrightarrow}A\\
(4)&C\stackrel{M}{\longrightarrow}A \stackrel{M}{\longrightarrow}C\stackrel{M}{\longrightarrow}A\stackrel{H}{\longrightarrow}C\\
(5)&C\stackrel{M}{\longrightarrow}A \stackrel{M}{\longrightarrow}C\stackrel{M}{\longrightarrow}A\stackrel{M}{\longrightarrow}C\stackrel{H}{\longrightarrow}A\\
(6)&C\stackrel{M}{\longrightarrow}A \stackrel{M}{\longrightarrow}C\stackrel{M}{\longrightarrow}A\stackrel{M}{\longrightarrow}C\stackrel{M}{\longrightarrow}A\stackrel{H}{\longrightarrow}C\\
&\cdots
\end{array}
\]
The probability of $A$ wins by eventually hitting $C$ is the sum of the probabilities of the even-numbered scenarios in the list:
\begin{eqnarray*}
P(A\;\textsf{wins} \;| A\; \textsf{hits}\;B )&=&(0.5 \cdot 0.3) + \\
&&(0.5 \cdot 0.7) (0.5 \cdot 0.3) + \\
&&(0.5 \cdot 0.7) (0.5 \cdot 0.7) (0.5 \cdot 0.3)+ \cdots\\
&=&0.15 \sum_{i=0}^{\infty} 0.35^i= \frac{0.15}{1-0.35}=\frac{3}{13}\approx 0.2308\,.
\end{eqnarray*}
Similarly, the probability of $C$ winning is $\disfrac{0.5}{1-0.35}=\disfrac{1}{13}\approx 0.0760$.

The expectation is:
\vspace*{-4ex}
\[
\renewcommand*{\arraystretch}{2.5}
\begin{array}{l}
E(A \;\textsf{wins}) =E(A \;\textsf{wins}\;|\;A\;\textsf{misses}\;B) + E(A \;\textsf{wins}\;|\;A\;\textsf{hits}\;B)=\\
\qquad
\overbrace{1\cdot (0.7\cdot 1\cdot 0.3)}%
^{A\stackrel{M}{\longrightarrow}B, B\stackrel{H}{\longrightarrow}C, A\stackrel{H}{\longrightarrow}B}+

\overbrace{0\cdot (0.7\cdot 1\cdot 0.7\cdot 1)}%
^{A\stackrel{M}{\longrightarrow}B, B\stackrel{H}{\longrightarrow}C,A\stackrel{M}{\longrightarrow}B,B\stackrel{H}{\longrightarrow}A} +

\overbrace{1\cdot (0.2308)}%
^{A\stackrel{H}{\longrightarrow}B, C\stackrel{H}{\longleftrightarrow*}A,C\stackrel{H}{\longrightarrow}A} +
\overbrace{0\cdot (0.3\cdot (0.0769))}%
^{A\stackrel{H}{\longrightarrow}B, C\stackrel{H}{\longleftrightarrow}A,C\stackrel{H}{\longrightarrow}A}
\approx\\
\qquad 0.2792\,,
\end{array}
\]
which is higher than the expectation of winning by shooting at $C$ first.

\ans{2} If $A$ shoots into the air not hitting anyone then $B\stackrel{H}{\longrightarrow}C$ with probability $1$ and $A$ can try to hit $B$ with probability $0.3$. The expectation is:
\[
E(A \;\textsf{wins}|A\;\textsf{shoots in the air}) = 1\cdot(0.3) + 0\cdot(0.7)=0.3\,,
\]
which is better than the expectation for the other two strategies!

\textbf{Simulation}
\begin{verbatim}
For A fires first at C:
Expectation of wins = 0.2100
Average wins        = 0.2138
For A fires first at B:
Expectation of wins = 0.2792
Average wins        = 0.2754
For A fires in the air:
Expectation of wins = 0.3000
Average wins        = 0.3000
\end{verbatim}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
